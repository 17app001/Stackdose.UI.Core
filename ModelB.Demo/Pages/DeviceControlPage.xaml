<UserControl x:Class="ModelB.Demo.Pages.DeviceControlPage"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:core="http://schemas.stackdose.com/wpf"
             mc:Ignorable="d"
             d:DesignHeight="800" d:DesignWidth="1400">

    <UserControl.Triggers>
        <EventTrigger RoutedEvent="Loaded">
            <BeginStoryboard>
                <Storyboard>
                    <!-- Fade In Animation -->
                    <DoubleAnimation Storyboard.TargetName="MainGrid"
                                   Storyboard.TargetProperty="Opacity"
                                   From="0.0"
                                   To="1.0"
                                   Duration="0:0:0.8"
                                   AccelerationRatio="0.2"
                                   DecelerationRatio="0.2"/>
                    <!-- Slide In Animation -->
                    <DoubleAnimation Storyboard.TargetName="MainGridTransform"
                                   Storyboard.TargetProperty="Y"
                                   From="30"
                                   To="0"
                                   Duration="0:0:0.8"
                                   AccelerationRatio="0.2"
                                   DecelerationRatio="0.2"/>
                </Storyboard>
            </BeginStoryboard>
        </EventTrigger>
    </UserControl.Triggers>

    <Grid x:Name="MainGrid" Background="{StaticResource BackgroundBrush}" Opacity="0">
        <Grid.RenderTransform>
            <TranslateTransform x:Name="MainGridTransform" Y="30"/>
        </Grid.RenderTransform>
        
        <!-- Main Content Area -->
        <Grid Margin="0,0,0,16">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*"/>
                <ColumnDefinition Width="4*"/>
                <ColumnDefinition Width="4*"/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Device Status Display (Top Left) - No Border -->
            <StackPanel Grid.Column="0" Grid.Row="0"
                        Orientation="Horizontal" 
                        HorizontalAlignment="Left"
                        Margin="8,0,8,4">
                <TextBlock Text="Status:"
                           FontSize="16"
                           FontWeight="SemiBold"
                           Foreground="{DynamicResource Plc.Text.Label}"
                           VerticalAlignment="Center"
                           Margin="0,0,8,0"/>
                <TextBlock x:Name="DeviceStatusText"
                           Text="Uninitialized"
                           FontSize="16"
                           FontWeight="Bold"
                           Foreground="{DynamicResource Plc.Text.Value}"
                           VerticalAlignment="Center"/>
            </StackPanel>

            <!-- Process Status Indicator (Top Right) -->
            <core:ProcessStatusIndicator x:Name="ProcessStatus"
                                         Grid.Column="2"
                                         Grid.Row="0"
                                         HorizontalAlignment="Right"
                                         Margin="0,0,0,4"
                                         VerticalAlignment="Top"
                                         ProcessState="Idle"/>

            <!-- Left Section: Function Buttons (2*) -->
            <Border Grid.Column="0"
                    Grid.Row="1"
                    Background="{DynamicResource Sensor.Bg.Main}"
                    BorderBrush="{DynamicResource Sensor.Border}"
                    BorderThickness="1"
                    CornerRadius="6"
                    Padding="12"
                    Margin="0,0,8,0">
                <StackPanel>
                    <TextBlock Text="PROCESS CONTROL"
                               FontSize="16"
                               FontWeight="Bold"
                               Foreground="{DynamicResource Sensor.Text.Title}"
                               FontFamily="Consolas"
                               Margin="0,0,0,12"
                               HorizontalAlignment="Center"/>

                    <!-- Device Initialization -->
                    <core:SecuredButton x:Name="BtnDeviceInit"
                                      Content="Device Init"
                                      RequiredLevel="Admin"
                                      OperationName="Device Initialization"
                                      Margin="0,0,0,10"
                                      Click="BtnDeviceInit_Click"
                                      HorizontalAlignment="Stretch"/>

                    <!-- Start Process -->
                    <core:SecuredButton x:Name="BtnStartProcess"
                                      Content="Start Process"
                                      RequiredLevel="Operator"
                                      OperationName="Start Production Process"
                                      Theme="Success"
                                      Margin="0,0,0,10"
                                      Click="BtnStartProcess_Click"
                                      HorizontalAlignment="Stretch"
                                      IsEnabled="False"/>

                    <!-- Pause Process -->
                    <core:SecuredButton x:Name="BtnPauseProcess"
                                      Content="Pause Process"
                                      RequiredLevel="Operator"
                                      OperationName="Pause Production Process"
                                      Theme="Warning"
                                      Margin="0,0,0,10"
                                      Click="BtnPauseProcess_Click"
                                      HorizontalAlignment="Stretch"
                                      IsEnabled="False"/>

                    <!-- Cancel Process -->
                    <core:SecuredButton x:Name="BtnCancelProcess"
                                      Content="Cancel Process"
                                      RequiredLevel="Supervisor"
                                      OperationName="Cancel Production Process"
                                      Theme="Error"
                                      Margin="0,0,0,10"
                                      Click="BtnCancelProcess_Click"
                                      HorizontalAlignment="Stretch"
                                      IsEnabled="False"/>

                    <!-- Error Reset -->
                    <core:SecuredButton x:Name="BtnErrorReset"
                                      Content="Error Reset"
                                      RequiredLevel="Instructor"
                                      OperationName="Error Reset and Recovery"
                                      Margin="0,0,0,0"
                                      Click="BtnErrorReset_Click"
                                      HorizontalAlignment="Stretch"
                                      IsEnabled="False"/>
                </StackPanel>
            </Border>

            <!-- Center Section: Data Display + Live Log (4*) -->
            <Grid Grid.Column="1" Grid.Row="1" Margin="0,0,8,0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="6.5*"/>
                    <RowDefinition Height="3.5*"/>
                </Grid.RowDefinitions>

                <!-- Process Parameters with Circle Labels -->
                <Border Grid.Row="0"
                        Background="{DynamicResource Plc.Bg.Main}"
                        BorderBrush="{DynamicResource Plc.Border}"
                        BorderThickness="1"
                        CornerRadius="6"
                        Padding="16,16"
                        Margin="0,0,0,8">
                    <StackPanel>
                        <!-- Temperature Parameters (Circular) -->
                        <UniformGrid Columns="3" Rows="2" Margin="0,0,0,12">
                            <core:PlcLabel Label="PreDry Temp"
                                         Address="D104"
                                         DataType="Word"
                                         Divisor="10"
                                         StringFormat="F1"
                                         FrameShape="Circle"
                                         FrameBackground="DarkBlue"
                                         ValueForeground="NeonRed"
                                         LabelForeground="Default"
                                         ValueFontSize="28"
                                         LabelFontSize="14"
                                         ShowAddress="False"
                                         Width="120"
                                         Height="120"
                                         Margin="4"/>

                            <core:PlcLabel Label="Zone1 Temp"
                                         Address="D106"
                                         DataType="Word"
                                         Divisor="10"
                                         StringFormat="F1"
                                         FrameShape="Circle"
                                         FrameBackground="DarkBlue"
                                         ValueForeground="NeonRed"
                                         LabelForeground="Default"
                                         ValueFontSize="28"
                                         LabelFontSize="14"
                                         ShowAddress="False"
                                         Width="120"
                                         Height="120"
                                         Margin="4"/>

                            <core:PlcLabel Label="Zone2 Temp"
                                         Address="D108"
                                         DataType="Word"
                                         Divisor="10"
                                         StringFormat="F1"
                                         FrameShape="Circle"
                                         FrameBackground="DarkBlue"
                                         ValueForeground="NeonRed"
                                         LabelForeground="Default"
                                         ValueFontSize="28"
                                         LabelFontSize="14"
                                         ShowAddress="False"
                                         Width="120"
                                         Height="120"
                                         Margin="4"/>

                            <core:PlcLabel Label="PreDry Time"
                                         Address="D105"
                                         DataType="Word"
                                         StringFormat="F0"
                                         FrameShape="Circle"
                                         FrameBackground="DarkBlue"
                                         ValueForeground="NeonBlue"
                                         LabelForeground="Default"
                                         ValueFontSize="26"
                                         LabelFontSize="14"
                                         ShowAddress="False"
                                         Width="120"
                                         Height="120"
                                         Margin="4"/>

                            <core:PlcLabel Label="Zone1 Time"
                                         Address="D107"
                                         DataType="Word"
                                         StringFormat="F0"
                                         FrameShape="Circle"
                                         FrameBackground="DarkBlue"
                                         ValueForeground="NeonBlue"
                                         LabelForeground="Default"
                                         ValueFontSize="26"
                                         LabelFontSize="14"
                                         ShowAddress="False"
                                         Width="120"
                                         Height="120"
                                         Margin="4"/>

                            <core:PlcLabel Label="Zone2 Time"
                                         Address="D109"
                                         DataType="Word"
                                         StringFormat="F0"
                                         FrameShape="Circle"
                                         FrameBackground="DarkBlue"
                                         ValueForeground="NeonBlue"
                                         LabelForeground="Default"
                                         ValueFontSize="26"
                                         LabelFontSize="14"
                                         ShowAddress="False"
                                         Width="120"
                                         Height="120"
                                         Margin="4"/>
                        </UniformGrid>

                        <!-- Flow and Pressure Parameters (Rectangle) -->
                        <UniformGrid Columns="2" Rows="2">
                            <core:PlcLabel Label="CDA Flow"
                                         Address="D100"
                                         DataType="Word"
                                         Divisor="10"
                                         StringFormat="F1"
                                         ValueForeground="NeonGreen"
                                         ValueFontSize="24"
                                         LabelFontSize="14"
                                         ShowAddress="False"
                                         Margin="4"/>

                            <core:PlcLabel Label="CDA Volume"
                                         Address="D101"
                                         DataType="Word"
                                         Divisor="10"
                                         StringFormat="F1"
                                         ValueForeground="NeonGreen"
                                         ValueFontSize="24"
                                         LabelFontSize="14"
                                         ShowAddress="False"
                                         Margin="4"/>

                            <core:PlcLabel Label="Swing Speed"
                                         Address="D102"
                                         DataType="Word"
                                         StringFormat="F0"
                                         ValueForeground="NeonBlue"
                                         ValueFontSize="24"
                                         LabelFontSize="14"
                                         ShowAddress="False"
                                         Margin="4"/>

                            <core:PlcLabel Label="Batch No"
                                         Address="D103"
                                         DataType="Word"
                                         StringFormat="F0"
                                         ValueForeground="NeonBlue"
                                         ValueFontSize="24"
                                         LabelFontSize="14"
                                         ShowAddress="False"
                                         Margin="4"/>
                        </UniformGrid>
                    </StackPanel>
                </Border>

                <!-- Live Log Viewer -->
                <Border Grid.Row="1"
                        Background="{DynamicResource Log.Bg.Main}"
                        BorderBrush="{DynamicResource Log.Border}"
                        BorderThickness="1"
                        CornerRadius="6">
                    <core:LiveLogViewer x:Name="MainLogViewer"/>
                </Border>
            </Grid>

            <!-- Right Section: Alarm + Sensor (4*) -->
            <Grid Grid.Column="2" Grid.Row="1">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Alarm Viewer (Top 50%) - Temporarily Empty -->
                <Border Grid.Row="0"
                        Background="{DynamicResource Sensor.Bg.Main}"
                        BorderBrush="{DynamicResource Sensor.Border}"
                        BorderThickness="1"
                        CornerRadius="6"
                        Margin="0,0,0,4">
                    <Grid>
                        <TextBlock Text="ALARM MONITORING"
                                   FontSize="18"
                                   FontWeight="Bold"
                                   Foreground="{DynamicResource Sensor.Text.Title}"
                                   FontFamily="Consolas"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Top"
                                   Margin="0,16,0,0"/>
                        <TextBlock Text="[No Active Alarms]"
                                   FontSize="14"
                                   Foreground="{DynamicResource Plc.Text.Label}"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center"/>
                    </Grid>
                </Border>

                <!-- Sensor Viewer (Bottom 50%) -->
                <Border Grid.Row="1"
                        Background="{DynamicResource Sensor.Bg.Main}"
                        BorderBrush="{DynamicResource Sensor.Border}"
                        BorderThickness="1"
                        CornerRadius="6"
                        Margin="0,4,0,0">
                    <ScrollViewer VerticalScrollBarVisibility="Auto"
                                  HorizontalScrollBarVisibility="Disabled">
                        <core:SensorViewer x:Name="MainSensorViewer"
                                         Title="SENSOR MONITORING"
                                         ConfigFile="Sensors.json"/>
                    </ScrollViewer>
                </Border>
            </Grid>
        </Grid>
    </Grid>
</UserControl>
