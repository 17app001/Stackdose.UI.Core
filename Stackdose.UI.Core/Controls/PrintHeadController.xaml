<UserControl x:Class="Stackdose.UI.Core.Controls.PrintHeadController"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" d:DesignWidth="700" Height="343">

	<UserControl.Resources>
		<!-- 現代按鈕樣式 -->
		<Style x:Key="ModernButtonStyle" TargetType="Button">
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="Button">
						<Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="3">
							<ContentPresenter HorizontalAlignment="Center" 
                                              VerticalAlignment="Center"
                                              Margin="6,3"/>
						</Border>
						<ControlTemplate.Triggers>
							<Trigger Property="IsMouseOver" Value="True">
								<Setter Property="Opacity" Value="0.9"/>
							</Trigger>
							<Trigger Property="IsPressed" Value="True">
								<Setter Property="Opacity" Value="0.8"/>
							</Trigger>
							<Trigger Property="IsEnabled" Value="False">
								<Setter Property="Opacity" Value="0.5"/>
							</Trigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

		<!-- 精簡輸入框樣式 -->
		<Style x:Key="CompactTextBoxStyle" TargetType="TextBox">
			<Setter Property="Background" Value="White"/>
			<Setter Property="Foreground" Value="Black"/>
			<Setter Property="BorderBrush" Value="#AAAAAA"/>
			<Setter Property="BorderThickness" Value="1"/>
			<Setter Property="Padding" Value="4,2"/>
			<Setter Property="VerticalContentAlignment" Value="Center"/>
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="TextBox">
						<Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="2">
							<ScrollViewer x:Name="PART_ContentHost" 
                                          Margin="{TemplateBinding Padding}"/>
						</Border>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

		<!-- 下拉選單樣式 -->
		<Style x:Key="ModernComboBoxStyle" TargetType="ComboBox">
			<Setter Property="Foreground" Value="White"/>
			<Setter Property="Background" Value="#2C3E50"/>
			<Setter Property="BorderBrush" Value="#34495E"/>
			<Setter Property="Padding" Value="8,4"/>
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="ComboBox">
						<Grid>
							<ToggleButton x:Name="ToggleButton"
                                          Focusable="false"
                                          IsChecked="{Binding Path=IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
                                          ClickMode="Press"
                                          Background="{TemplateBinding Background}"
                                          BorderBrush="{TemplateBinding BorderBrush}"
                                          BorderThickness="1">
								<ToggleButton.Template>
									<ControlTemplate TargetType="ToggleButton">
										<Border x:Name="Border"
                                                Background="{TemplateBinding Background}"
                                                BorderBrush="{TemplateBinding BorderBrush}"
                                                BorderThickness="1"
                                                CornerRadius="3">
											<Grid>
												<Grid.ColumnDefinitions>
													<ColumnDefinition Width="*"/>
													<ColumnDefinition Width="20"/>
												</Grid.ColumnDefinitions>
												<Path Grid.Column="1"
                                                      HorizontalAlignment="Center"
                                                      VerticalAlignment="Center"
                                                      Data="M 0 0 L 4 4 L 8 0 Z"
                                                      Fill="White"/>
											</Grid>
										</Border>
									</ControlTemplate>
								</ToggleButton.Template>
							</ToggleButton>
							<ContentPresenter x:Name="ContentSite"
                                              IsHitTestVisible="False"
                                              Content="{TemplateBinding SelectionBoxItem}"
                                              ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                                              ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}"
                                              Margin="8,0,23,0"
                                              VerticalAlignment="Center"
                                              HorizontalAlignment="Left">
								<ContentPresenter.Resources>
									<Style TargetType="{x:Type TextBlock}">
										<Setter Property="Foreground" Value="White"/>
									</Style>
								</ContentPresenter.Resources>
							</ContentPresenter>
							<Popup x:Name="Popup"
                                   Placement="Bottom"
                                   IsOpen="{TemplateBinding IsDropDownOpen}"
                                   AllowsTransparency="True"
                                   Focusable="False"
                                   PopupAnimation="Slide">
								<Grid x:Name="DropDown"
                                      SnapsToDevicePixels="True"
                                      MinWidth="{TemplateBinding ActualWidth}"
                                      MaxHeight="{TemplateBinding MaxDropDownHeight}">
									<Border x:Name="DropDownBorder"
                                            Background="#2C3E50"
                                            BorderBrush="#34495E"
                                            BorderThickness="1"
                                            CornerRadius="3">
										<ScrollViewer Margin="4,6,4,6" SnapsToDevicePixels="True">
											<ItemsPresenter KeyboardNavigation.DirectionalNavigation="Contained"/>
										</ScrollViewer>
									</Border>
								</Grid>
							</Popup>
						</Grid>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
			<Setter Property="ItemContainerStyle">
				<Setter.Value>
					<Style TargetType="ComboBoxItem">
						<Setter Property="Foreground" Value="White"/>
						<Setter Property="Background" Value="Transparent"/>
						<Setter Property="Padding" Value="8,4"/>
						<Setter Property="Template">
							<Setter.Value>
								<ControlTemplate TargetType="ComboBoxItem">
									<Border x:Name="Border"
                                            Background="{TemplateBinding Background}"
                                            BorderThickness="0"
                                            Padding="{TemplateBinding Padding}">
										<ContentPresenter/>
									</Border>
									<ControlTemplate.Triggers>
										<Trigger Property="IsHighlighted" Value="True">
											<Setter TargetName="Border" Property="Background" Value="#3498DB"/>
										</Trigger>
										<Trigger Property="IsSelected" Value="True">
											<Setter TargetName="Border" Property="Background" Value="#34495E"/>
											<Setter Property="FontWeight" Value="Bold"/>
										</Trigger>
									</ControlTemplate.Triggers>
								</ControlTemplate>
							</Setter.Value>
						</Setter>
					</Style>
				</Setter.Value>
			</Setter>
		</Style>
	</UserControl.Resources>

	<Border Background="{DynamicResource Plc.Bg.Dark}" 
            BorderBrush="{DynamicResource Plc.Border}" 
            BorderThickness="1" 
            CornerRadius="4"
            Padding="8">
		<Grid>
			<Grid.RowDefinitions>
				<RowDefinition Height="Auto"/>
				<RowDefinition Height="6"/>
				<RowDefinition Height="Auto"/>
				<RowDefinition Height="6"/>
				<RowDefinition Height="*"/>
				<RowDefinition Height="6"/>
				<RowDefinition Height="Auto"/>
			</Grid.RowDefinitions>

			<!-- 標題列 -->
			<Border Grid.Row="0"
                    Background="Transparent"
                    Padding="2,0">
				<TextBlock Text="PrintHeadControl"
                           FontSize="11"
                           FontWeight="Bold"
                           Foreground="#ECF0F1"
                           VerticalAlignment="Center"/>
			</Border>

			<!-- 頂部控制列 -->
			<Border Grid.Row="2"
                    Background="#2C3E50"
                    BorderBrush="#34495E"
                    BorderThickness="1"
                    CornerRadius="3"
                    Padding="6">
				<Grid>
					<Grid.ColumnDefinitions>
						<ColumnDefinition Width="Auto"/>
						<ColumnDefinition Width="8"/>
						<ColumnDefinition Width="Auto"/>
						<ColumnDefinition Width="8"/>
						<ColumnDefinition Width="Auto"/>
						<ColumnDefinition Width="*"/>
						<ColumnDefinition Width="Auto"/>
					</Grid.ColumnDefinitions>

					<!-- 閃噴控制組 -->
					<StackPanel Grid.Column="0" Orientation="Horizontal">
						<TextBlock Text="閃噴頻率"
                                   FontSize="9"
                                   FontWeight="Bold"
                                   Foreground="#ECF0F1"
                                   VerticalAlignment="Center"
                                   Margin="0,0,6,0"/>

						<Border Background="White"
                                BorderBrush="#AAAAAA"
                                BorderThickness="1"
                                CornerRadius="2"
                                Padding="4,2">
							<StackPanel Orientation="Horizontal">
								<TextBox x:Name="FrequencyBox"
                                         Text="0.1,1,1,1"
                                         Width="85"
                                         FontSize="9"
                                         BorderThickness="0"
                                         Background="Transparent"
                                         VerticalContentAlignment="Center"/>
								<TextBlock Text="KHz"
                                           FontSize="8"
                                           Foreground="#666666"
                                           VerticalAlignment="Center"
                                           Margin="3,0,0,0"/>
							</StackPanel>
						</Border>
					</StackPanel>

					<!-- 執行閃噴按鈕 -->
					<Button Grid.Column="2"
                            Content="執行閃噴"
                            Width="70"
                            Height="26"
                            FontSize="9"
                            FontWeight="SemiBold"
                            Background="#27AE60"
                            Foreground="White"
                            BorderBrush="#229954"
                            Click="SpitButton_Click"
                            Style="{StaticResource ModernButtonStyle}"/>

					<!-- 編碼器重置按鈕 -->
					<Button Grid.Column="4"
                            Content="編碼器重置"
                            Width="80"
                            Height="26"
                            FontSize="9"
                            Background="#C228CA"
                            Foreground="White"
                            BorderBrush="#8E44AD"
                            Style="{StaticResource ModernButtonStyle}"/>

					<!-- 連線狀態 -->
					<Border Grid.Column="6"
                            Background="#1E1E1E"
                            BorderBrush="#34495E"
                            BorderThickness="1"
                            CornerRadius="3"
                            Padding="6,4">
						<StackPanel Orientation="Horizontal">
							<Ellipse Width="6" Height="6" 
                                     Fill="#2ECC71" 
                                     Margin="0,0,4,0"
                                     VerticalAlignment="Center"/>
							<TextBlock x:Name="ConnectedCountText"
                                       Text="0 已連線"
                                       FontSize="9"
                                       Foreground="#AAAAAA"
                                       VerticalAlignment="Center"/>
						</StackPanel>
					</Border>
				</Grid>
			</Border>

			<!-- 主要內容區域 -->
			<Grid Grid.Row="4">
				<Grid.ColumnDefinitions>
					<ColumnDefinition Width="120"/>
					<ColumnDefinition Width="8"/>
					<ColumnDefinition Width="*"/>
				</Grid.ColumnDefinitions>

				<!-- 左側控制面板 -->
				<Border Grid.Column="0"
                        Background="#2C3E50"
                        BorderBrush="#34495E"
                        BorderThickness="1"
                        CornerRadius="3"
                        Padding="6">
					<StackPanel>
						<!-- 圖片操作 -->
						<TextBlock Text="圖片操作"
                                   FontSize="9"
                                   FontWeight="Bold"
                                   Foreground="#ECF0F1"
                                   Margin="0,0,0,4"/>

						<Button Content="讀取圖片"
                                Height="26"
                                Margin="0,0,0,4"
                                FontSize="9"
                                Background="#3498DB"
                                Foreground="White"
                                BorderBrush="#2980B9"
                                Click="BrowseImageButton_Click"
                                Style="{StaticResource ModernButtonStyle}"/>

						<Button Content="載入任務"
                                Height="26"
                                Margin="0,0,0,4"
                                FontSize="9"
                                Background="#E67E22"
                                Foreground="White"
                                BorderBrush="#D35400"
                                Click="LoadImageButton_Click"
                                Style="{StaticResource ModernButtonStyle}"/>

						<Button Content="取消任務"
                                Height="26"
                                Margin="0,0,0,8"
                                FontSize="9"
                                Background="#E22424"
                                Foreground="White"
                                BorderBrush="#C0392B"
                                Style="{StaticResource ModernButtonStyle}"/>

						<!-- 列印方向 -->
						<TextBlock Text="列印方向"
                                   FontSize="9"
                                   FontWeight="Bold"
                                   Foreground="#ECF0F1"
                                   Margin="0,0,0,4"/>

						<ComboBox x:Name="DirectionCombo"
                                  Height="24"
                                  FontSize="9"
                                  Margin="0,0,0,8"
                                  SelectedIndex="0"
                                  Style="{StaticResource ModernComboBoxStyle}">
							<ComboBoxItem Content="雙向列印"/>
							<ComboBoxItem Content="左到右"/>
							<ComboBoxItem Content="右到左"/>
						</ComboBox>

						<!-- 列印參數 -->
						<TextBlock Text="列印參數"
                                   FontSize="9"
                                   FontWeight="Bold"
                                   Foreground="#ECF0F1"
                                   Margin="0,0,0,4"/>

						<Grid>
							<Grid.RowDefinitions>
								<RowDefinition Height="Auto"/>
								<RowDefinition Height="4"/>
								<RowDefinition Height="Auto"/>
							</Grid.RowDefinitions>
							<Grid.ColumnDefinitions>
								<ColumnDefinition Width="42"/>
								<ColumnDefinition Width="*"/>
							</Grid.ColumnDefinitions>

							<TextBlock Grid.Row="0" Grid.Column="0"
                                       Text="起點X："
                                       FontSize="8"
                                       Foreground="#BDC3C7"
                                       VerticalAlignment="Center"/>
							<TextBox Grid.Row="0" Grid.Column="1"
                                     x:Name="StartXBox"
                                     Text="50"
                                     Height="20"
                                     FontSize="8"
                                     Style="{StaticResource CompactTextBoxStyle}"/>

							<TextBlock Grid.Row="2" Grid.Column="0"
                                       Text="校正值："
                                       FontSize="8"
                                       Foreground="#BDC3C7"
                                       VerticalAlignment="Center"/>
							<TextBox Grid.Row="2" Grid.Column="1"
                                     x:Name="CaliMMBox"
                                     Text="30.5"
                                     Height="20"
                                     FontSize="8"
                                     Style="{StaticResource CompactTextBoxStyle}"/>
						</Grid>
					</StackPanel>
				</Border>

				<!-- 中央圖片預覽區域 -->
				<Border Grid.Column="2"
                        Background="#1E1E1E"
                        BorderBrush="#34495E"
                        BorderThickness="1"
                        CornerRadius="3">
					<Grid>
						<Image x:Name="PreviewImage"
                               Stretch="Uniform"
                               Margin="6"/>

						<TextBlock x:Name="ImageInfoText"
                                   Text="尚未載入圖片"
                                   FontSize="10"
                                   Foreground="#7F8C8D"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center"
                                   Visibility="Visible"/>
					</Grid>
				</Border>
			</Grid>

			<!-- 底部狀態列 -->
			<Border Grid.Row="6"
                    Background="#2C3E50"
                    BorderBrush="#34495E"
                    BorderThickness="1"
                    CornerRadius="3"
                    Padding="6,4">
				<Grid>
					<Grid.ColumnDefinitions>
						<ColumnDefinition Width="Auto"/>
						<ColumnDefinition Width="*"/>
						<ColumnDefinition Width="Auto"/>
						<ColumnDefinition Width="8"/>
						<ColumnDefinition Width="Auto"/>
						<ColumnDefinition Width="8"/>
						<ColumnDefinition Width="Auto"/>
						<ColumnDefinition Width="8"/>
						<ColumnDefinition Width="Auto"/>
					</Grid.ColumnDefinitions>

					<!-- 檔案路徑 -->
					<TextBlock Grid.Column="0"
                               Text="檔案："
                               FontSize="8"
                               Foreground="#BDC3C7"
                               VerticalAlignment="Center"/>

					<TextBlock Grid.Column="1"
                               x:Name="FilePathText"
                               Text="尚未選擇檔案"
                               FontSize="8"
                               Foreground="#ECF0F1"
                               VerticalAlignment="Center"
                               Margin="3,0,0,0"
                               TextTrimming="CharacterEllipsis"/>

					<!-- 圖片寬度 -->
					<StackPanel Grid.Column="2" Orientation="Horizontal">
						<TextBlock Text="寬度："
                                   FontSize="8"
                                   Foreground="#BDC3C7"
                                   VerticalAlignment="Center"/>
						<TextBlock x:Name="ImageWidthText"
                                   Text="-"
                                   FontSize="8"
                                   FontWeight="Bold"
                                   Foreground="#3498DB"
                                   VerticalAlignment="Center"
                                   Margin="3,0,0,0"/>
					</StackPanel>

					<!-- 圖片高度 -->
					<StackPanel Grid.Column="4" Orientation="Horizontal">
						<TextBlock Text="高度："
                                   FontSize="8"
                                   Foreground="#BDC3C7"
                                   VerticalAlignment="Center"/>
						<TextBlock x:Name="ImageHeightText"
                                   Text="-"
                                   FontSize="8"
                                   FontWeight="Bold"
                                   Foreground="#3498DB"
                                   VerticalAlignment="Center"
                                   Margin="3,0,0,0"/>
					</StackPanel>

					<!-- 水平 DPI -->
					<StackPanel Grid.Column="6" Orientation="Horizontal">
						<TextBlock Text="水平DPI："
                                   FontSize="8"
                                   Foreground="#BDC3C7"
                                   VerticalAlignment="Center"/>
						<TextBlock x:Name="XDpiText"
                                   Text="-"
                                   FontSize="8"
                                   FontWeight="Bold"
                                   Foreground="#3498DB"
                                   VerticalAlignment="Center"
                                   Margin="3,0,0,0"/>
					</StackPanel>

					<!-- 垂直 DPI -->
					<StackPanel Grid.Column="8" Orientation="Horizontal">
						<TextBlock Text="垂直DPI："
                                   FontSize="8"
                                   Foreground="#BDC3C7"
                                   VerticalAlignment="Center"/>
						<TextBlock x:Name="YDpiText"
                                   Text="-"
                                   FontSize="8"
                                   FontWeight="Bold"
                                   Foreground="#3498DB"
                                   VerticalAlignment="Center"
                                   Margin="3,0,0,0"/>
					</StackPanel>
				</Grid>
			</Border>
		</Grid>
	</Border>
</UserControl>
