# PrintHeadController 重新設計文件

## ?? 概述

PrintHeadController 已重新設計為更緊湊的橫向佈局，類似於圖片中顯示的介面風格，提供更好的空間利用率和使用體驗。

## ? 新介面佈局

### 整體結構

```
┌────────────────────────────────────────────────────────────┐
│ 閃噴 [0.1] Khz [執行] [光閘確率]            0 Connected   │
├───────────┬────────────────────────────────────────────────┤
│[讀取圖片] │                                                │
│[載入佇列] │                                                │
│[範圍佇列] │         圖片預覽區域                            │
│           │                                                │
│寬度:49606 │                                                │
│長度:1631  │                                                │
│           │                                                │
│[Bidirect] │                                                │
│StartX: 50 │                                                │
│CaliMM:30.5│                                                │
├───────────┴────────────────────────────────────────────────┤
│圖檔路徑: _10.6in12mm_w700...     XDPI: 1800  YDPI: 360   │
└────────────────────────────────────────────────────────────┘
```

## ?? 主要區域

### 1. **頂部控制列**

#### 閃噴控制
- **標籤**: "閃噴"
- **頻率輸入框**: 60px 寬，預設 "0.1"
- **單位標籤**: "Khz"
- **執行按鈕**: 淺綠色背景 (#90EE90)
- **光閘確率按鈕**: 灰色背景

#### 連接狀態
- 顯示在右上角
- 格式: "X Connected"
- 顏色: 灰色

### 2. **左側控制面板** (寬度: 110px)

#### 主要按鈕
1. **讀取圖片**
   - 點擊開啟檔案選擇對話框
   - 支援 BMP, PNG, JPG 格式

2. **載入佇列**
   - 將選擇的圖片載入到噴頭佇列

3. **範圍佇列**
   - 設定列印範圍

#### 圖片資訊顯示
- **寬度**: 顯示像素寬度
- **長度**: 顯示像素高度
- 顏色: 青色 (#00d4ff)
- 字體: 10px

#### 列印參數
1. **Direction 下拉選單**
   - Bidirection (雙向)
   - LeftToRight (左到右)
   - RightToLeft (右到左)

2. **StartX 輸入框**
   - 標籤: "StartX:"
   - 預設值: 50
   - 單位: mm

3. **CaliMM 輸入框**
   - 標籤: "CaliMM:"
   - 預設值: 30.5
   - 單位: mm

### 3. **圖片預覽區域**

#### 特點
- 佔據右側大部分空間
- 深灰色背景 (#404040)
- 自動縮放顯示圖片
- 底部顯示檔案名稱

#### 顯示資訊
- 圖片縮圖
- 檔案名稱 (左下角)

### 4. **底部狀態列**

#### 顯示內容
- **圖檔路徑**: 完整檔案名稱
- **XDPI**: 水平解析度
- **YDPI**: 垂直解析度

#### 資訊格式
```
圖檔路徑: _10.6in12mm_w700_1800x360DPI_左銅性校正0.3mm_排1.bmp    XDPI: 1800  YDPI: 360
```

## ?? 視覺設計

### 顏色方案

#### 背景顏色
- **主背景**: `{DynamicResource Plc.Bg.Dark}`
- **預覽區**: `#404040` (深灰)
- **輸入框**: `White`

#### 文字顏色
- **標籤**: `{DynamicResource Plc.Text.Label}`
- **數值**: `#00d4ff` (青色)
- **輸入**: `Black`
- **狀態**: `Gray`

#### 按鈕顏色
- **執行按鈕**: `#90EE90` (淺綠)
- **一般按鈕**: `{DynamicResource Plc.Bg.Main}`

### 字體大小
- **主標籤**: 12px
- **按鈕文字**: 11px
- **屬性標籤**: 10px
- **屬性值**: 10px
- **輸入框**: 10-11px
- **狀態列**: 9px

### 圓角和邊框
- **主邊框**: 5px 圓角
- **按鈕**: 3px 圓角
- **輸入框**: 2px 圓角
- **預覽區**: 3px 圓角

## ?? 功能說明

### 圖片載入流程

1. **選擇圖片**
   ```
   點擊 [讀取圖片] → 開啟檔案對話框 → 選擇圖片
   ```

2. **自動更新資訊**
   - 顯示圖片預覽
   - 更新寬度、長度
   - 更新 XDPI、YDPI
   - 顯示檔案路徑

3. **載入到噴頭**
   ```
   點擊 [載入佇列] → 傳送到所有已連接的噴頭
   ```

### 閃噴執行

1. **設定頻率**
   - 在頻率輸入框輸入數值
   - 單位: kHz

2. **執行閃噴**
   ```
   點擊 [執行] → 對所有噴頭執行閃噴 → 顯示結果
   ```

### 列印參數設定

1. **選擇列印方向**
   - Bidirection: 雙向列印
   - LeftToRight: 單向左到右
   - RightToLeft: 單向右到左

2. **設定起始位置**
   - StartX: 列印起始 X 座標 (mm)
   - CaliMM: 校正值 (mm)

## ?? 屬性對應表

| UI 元件 | 綁定屬性 | 資料來源 |
|---------|---------|---------|
| FrequencyBox | Text | 閃噴頻率 |
| DirectionCombo | SelectedIndex | 列印方向 |
| StartXBox | Text | 起始 X 座標 |
| CaliMMBox | Text | 校正值 |
| ImageWidthText | Text | 圖片寬度 |
| ImageHeightText | Text | 圖片長度 |
| XDpiText | Text | 水平 DPI |
| YDpiText | Text | 垂直 DPI |
| FilePathText | Text | 檔案路徑 |
| PreviewImage | Source | 圖片預覽 |
| ConnectedCountText | Text | 連接數量 |

## ?? 與舊版本的差異

### 佈局變更
| 項目 | 舊版本 | 新版本 |
|------|--------|--------|
| 排列方向 | 垂直 | 橫向 |
| 控制面板 | 分散在多個區域 | 集中在左側 |
| 圖片預覽 | 無 | 大型預覽區 |
| 資訊顯示 | 分散 | 統一在底部 |

### 功能簡化
1. **移除的功能**
   - Encoder Reset (編碼器重置)
   - Work Duration, Idle Duration, Drops 參數
   - Start/Pause/Stop All 按鈕

2. **保留的核心功能**
   - 圖片載入和預覽
   - 閃噴控制
   - 列印方向設定
   - StartX 和校正值設定

3. **新增功能**
   - 即時圖片預覽
   - 光閘確率按鈕
   - 範圍佇列功能

## ?? 設計優勢

### 空間利用
- ? 橫向佈局更適合寬螢幕
- ? 左側控制面板寬度固定，節省空間
- ? 大型預覽區域提供更好的視覺反饋

### 操作流程
- ? 相關控制項集中在一起
- ? 按鈕順序符合操作流程
- ? 資訊顯示位置合理

### 視覺一致性
- ? 統一的顏色方案
- ? 一致的圓角和邊框
- ? 清晰的視覺層次

## ?? 程式碼重點

### XAML 結構
```xaml
<Grid>
    <!-- 頂部控制列 -->
    <Grid Grid.Row="0">
        <!-- 閃噴控制 -->
        <!-- 連接狀態 -->
    </Grid>
    
    <!-- 主要內容 -->
    <Grid Grid.Row="2">
        <!-- 左側控制面板 -->
        <StackPanel Grid.Column="0">
            <!-- 按鈕 -->
            <!-- 資訊顯示 -->
            <!-- 參數輸入 -->
        </StackPanel>
        
        <!-- 圖片預覽區 -->
        <Border Grid.Column="2">
            <Image x:Name="PreviewImage"/>
        </Border>
    </Grid>
    
    <!-- 底部狀態列 -->
    <Grid Grid.Row="4">
        <!-- 檔案路徑 -->
        <!-- DPI 資訊 -->
    </Grid>
</Grid>
```

### C# 關鍵方法
```csharp
// 載入圖片資訊和預覽
private void LoadImageInfo(string imagePath)
{
    // 讀取圖片屬性
    // 更新 UI 顯示
    // 載入預覽圖
}

// 執行閃噴
private async void SpitButton_Click(object sender, RoutedEventArgs e)
{
    // 驗證參數
    // 對所有噴頭執行
    // 顯示結果
}

// 載入圖片到噴頭
private void LoadImageButton_Click(object sender, RoutedEventArgs e)
{
    // 驗證檔案
    // 傳送到所有噴頭
    // 記錄結果
}
```

## ?? 測試建議

### 介面測試
1. 調整視窗大小驗證佈局
2. 測試深色/淺色主題切換
3. 驗證所有按鈕響應

### 功能測試
1. 載入不同格式的圖片
2. 測試閃噴功能
3. 驗證列印參數設定
4. 測試多個噴頭連接

### 相容性測試
1. 不同解析度螢幕
2. 不同 DPI 設定
3. 不同圖片尺寸

## ?? 版本資訊

- **版本**: 2.0
- **設計日期**: 2024年
- **狀態**: ? 已完成
- **編譯**: ? 成功

---

**備註**: 新設計更加緊湊和直觀，提供更好的使用體驗和視覺反饋。
